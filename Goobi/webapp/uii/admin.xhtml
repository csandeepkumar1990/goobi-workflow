<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:o="http://omnifaces.org/ui"
    xmlns:of="http://omnifaces.org/functions"
    template="/uii/template/template.html"
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites">

    <ui:param
        name="myPageTitle"
        value="#{msgs.administrationsaufgaben}" />

    <ui:define name="breadcrumb">
        <intranda:breadcrumb
            id="index"
            label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}"
            action="index"
            navId="a0" />
        <intranda:breadcrumb
            id="admin"
            label="#{msgs.administrationsaufgaben}"
            action="admin.xhtml"
            noSeparator="#{true}" />
    </ui:define>

    <ui:define name="info">
    </ui:define>

    <ui:define name="content">
        <h:form rendered="#{LoginForm.hasRole('Admin_Administrative_Tasks')}">

            <div class="row">
                <div class="col-sm-12">
                    <div class="box box-bordered box-small box-color orange">
                        <div class="box-title">
                            <h3>
                                <i class="fa fa-exclamation-triangle"></i>
                                <h:outputText
                                    id="id6"
                                    value="#{msgs.benutzerZumAusloggenAuffordern}" />
                            </h3>
                        </div>
                        <div class="box-content">

                            <div class="row">
                                <div class="col-sm-3">
                                    <label class="control-label">#{msgs.message}:</label>
                                </div>
                                <div class="col-sm-9">
                                    <h:inputTextarea
                                        styleClass="form-control"
                                        value="#{SessionForm.bitteAusloggen}" />
                                </div>
                            </div>

                            <hr class="margin-top-regular margin-bottom-regular" />

                            <div class="margin-top-regular">
                                <h:commandLink
                                    styleClass="btn btn-primary font-size-s pull-right"
                                    value="#{msgs.uebernehmen}"
                                    action="admin.xhtml" />
                            </div>

                        </div>
                    </div>

                    <!--                     <div class="box box-bordered box-small lightgrey"> -->
                    <!--                         <div class="box-title"> -->
                    <!--                             <h3> -->
                    <!--                                 <i class="fa fa-exclamation-triangle"></i> -->
                    <!--                                 <h:outputText value="#{msgs.administrationsaufgaben}" /> -->
                    <!--                             </h3> -->
                    <!--                         </div> -->
                    <!--                         <div class="box-content"> -->

                    <!--                             <div class="row"> -->
                    <!--                                 <div class="col-sm-9"> -->
                    <!--                                     <label class="control-label">History update</label> -->
                    <!--                                 </div> -->
                    <!--                                 <div class="col-sm-3"> -->
                    <!--                                     <h:commandLink styleClass="btn font-size-s pull-right" action="#{AdministrationForm.startStorageCalculationForAllProcessesNow}" immediate="true" value="Run complete history analyser job now" /> -->
                    <!--                                 </div> -->
                    <!--                             </div> -->
                    <!--                         </div> -->
                    <!--                     </div> -->

                </div>
            </div>
        </h:form>


        <div class="row">
            <div class="col-sm-12">
                <div class="box box-color box-bordered">
                    <div class="box-title">
                        <h3>
                            <i class="fa fa-list"></i>
                            <h:outputText value="#{myPageTitle}" />
                        </h3>
                    </div>
                    <div class="box-content nopadding">

                        <h:form id="queue">

                            <x:dataTable
                                styleClass="table table-hover table-bordered"
                                var="ticket"
                                value="#{jmsBean.activeSlowQueryMesssages}">

                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_id}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.messageId}" />
                                </x:column>

                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_type}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.taskType}" />
                                </x:column>

                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_processId}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.processId}" />
                                </x:column>
                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_processName}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.processName}" />
                                </x:column>


                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_stepId}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.stepId}" />
                                </x:column>
                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_stepName}" />
                                    </f:facet>
                                    <h:outputText value="#{ticket.stepName}" />
                                </x:column>
                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.message_queue_ticket_properties}" />
                                    </f:facet>
                                    <x:dataList
                                        var="prop"
                                        value="#{ticket.properties.keySet()}">
                                        <h:outputText value="#{prop}: #{ticket.properties[prop]} " />
                                        <br />
                                    </x:dataList>
                                </x:column>
                                <x:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msgs.auswahl}" />
                                    </f:facet>
                                    <h:commandLink
                                        action="#{jmsBean.deleteSlowQueryTicket(ticket)}"
                                        rel="tooltip"
                                        onclick="preventDoubleSubmit(this);"
                                        title="#{msgs.message_queue_cancel_ticket}">
                                        <i class="btn fa fa-trash-o" />
                                    </h:commandLink>
                                </x:column>
                            </x:dataTable>
                            <div class="dataTables_info">
                                <h:commandLink
                                    styleClass="btn pull-right font-size-s"
                                    action="#{jmsBean.clearSlowQueryQueue}"
                                    title="#{msgs.message_queue_clear}">
                                    <i class="fa fa-trash-o margin-right-less" />
                                    <h:outputText value="#{msgs.message_queue_clear}" />
                                </h:commandLink>

                                <h:commandLink
                                    styleClass="btn margin-right-10"
                                    title="queue"
                                    action="#{jmsBean.initConnection}">
                                    <h:outputText value="queue" />
                                </h:commandLink>

                                <h:commandLink
                                    styleClass="btn margin-right-10"
                                    title="submitDummyTicket"
                                    action="#{jmsBean.submitDummyTicket}">
                                    <h:outputText value="submitDummyTicket" />
                                </h:commandLink>

                                <h:commandLink
                                    styleClass="btn margin-right-10"
                                    title="submitSlowQueryDummyTicket"
                                    action="#{jmsBean.submitSlowQueryDummyTicket}">
                                    <h:outputText value="submitSlowQueryDummyTicket" />
                                </h:commandLink>
                                <h:commandLink
                                    styleClass="btn margin-right-10"
                                    title="checkQueue"
                                    action="#{jmsBean.checkQueue}">
                                    <h:outputText value="checkQueue" />
                                </h:commandLink>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
        </div>









    </ui:define>

</ui:composition>