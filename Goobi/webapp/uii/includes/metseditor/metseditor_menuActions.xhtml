<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html" 
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core" 
    xmlns:x="http://myfaces.apache.org/tomahawk">

    <composite:interface />

    <composite:implementation>
        <h:form id="meMenuActionsForm">
            <ul class="clean">
                <!-- PAGE TITLE -->
                <li class="string">#{myPageTitle}</li>

                <!-- PROCESS ID -->
                <ui:fragment rendered="#{LoginForm.myBenutzer.metsDisplayProcessID}">
                    <li class="string">Goobi-ID: #{Metadaten.myProzess.id}</li>
                </ui:fragment>



                <!-- TOGGLE IMAGE VIEW -->
                <li>
                    <h:commandLink 
                        id="toggleImageView" 
                        action="#{Metadaten.toggleImageView}"
                        title="#{!Metadaten.treeProperties.showThumbnails?msgs.mets_showImagesThumbs:msgs.mets_showImagesOne}">
                        <i class="fa fa-picture-o fa-lg" aria-hidden="true"></i>
                        <i class="fa #{!Metadaten.treeProperties.showThumbnails ? 'fa-picture-o fa-lg' : ''}" aria-hidden="true"></i>
                        <x:updateActionListener value="true" property="#{NavigationForm.uiStatus.mets_scrollToThumb}" />
                        <x:updateActionListener     
                            value="#{Metadaten.treeProperties.showThumbnails?false:true}"
                            property="#{Metadaten.treeProperties.showThumbnails}" />
                        <f:passThroughAttribute name="data-toggle" value="tooltip" />
                        <f:passThroughAttribute name="data-placement" value="bottom" />
                    </h:commandLink>
                </li>
                
                <!-- VALIDATION -->
                <li>
                    <h:commandLink 
                        id="startValidation" 
                        action="#{Metadaten.Validate}" 
                        title="#{msgs.validieren}">
                        <i class="fa fa-check fa-lg" aria-hidden="true"></i>
                        <f:passThroughAttribute name="data-toggle" value="tooltip" />
                        <f:passThroughAttribute name="data-placement" value="bottom" />
                    </h:commandLink>
                </li>

                <!-- CONFIGURATION -->
                <li>
                    <button 
                        type="button" 
                        class="btn btn--clean" 
                        title="#{msgs.mets_configuration}" 
                        data-show="submenu"
                        data-toggle="tooltip"
                        data-placement="bottom">
                        <i class="fa fa-cog fa-lg" aria-hidden="true"></i>
                    </button>
                    <ul class="clean submenu">
                        <li>
                            <h:commandLink 
                                id="showtreelevel"
                                action="#{NavigationForm.Reload}">
                                <i class="fa fa-list-ol" aria-hidden="true"></i>
                                #{Metadaten.treeProperties.showtreelevel ? msgs.mets_treelevel_hide : msgs.mets_treelevel}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{Metadaten.treeProperties.showtreelevel?false:true}"
                                    property="#{Metadaten.treeProperties.showtreelevel}" />
                            </h:commandLink>
                        </li>

                        <li>
                            <h:commandLink 
                                action="#{NavigationForm.Reload}">
                                <i class="fa fa-list" aria-hidden="true"></i>
                                #{Metadaten.treeProperties.showtitle ? msgs.mets_treeTitle_hide : msgs.mets_treeTitle}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{Metadaten.treeProperties.showtitle?false:true}"
                                    property="#{Metadaten.treeProperties.showtitle}" />
                            </h:commandLink>
                        </li>

                        <li>
                            <h:commandLink 
                                action="#{NavigationForm.Reload}">
                                <i class="fa fa-exchange" aria-hidden="true"></i>
                                #{Metadaten.treeProperties.showfirstpagenumber ? msgs.mets_treePageNumber_hide : msgs.mets_treePageNumber}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{Metadaten.treeProperties.showfirstpagenumber?false:true}"
                                    property="#{Metadaten.treeProperties.showfirstpagenumber}" />
                            </h:commandLink>
                        </li>

                        <li>
                            <h:commandLink 
                                id="fullexpanded" 
                                action="#{Metadaten.TreeExpand}">
                                <i class="fa fa-indent" aria-hidden="true"></i>
                                #{not Metadaten.treeProperties.fullexpanded ? msgs.mets_treeExpand : msgs.mets_treeCompress}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{Metadaten.treeProperties.fullexpanded?false:true}"
                                    property="#{Metadaten.treeProperties.fullexpanded}" />
                            </h:commandLink>
                        </li>
                
                        <li>
                            <h:commandLink 
                                id="displayImage" 
                                action="#{Metadaten.BildAnzeigen}">
                                <i class="fa fa-picture-o" aria-hidden="true"></i>
                                #{Metadaten.bildAnzeigen == true ? msgs.metadatenBildAusblenden : msgs.metadatenBildAnzeigen}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                            </h:commandLink>
                        </li>
                
                        <c:if test="#{not Metadaten.nurLesenModus and LoginForm.hasRole('Task_Mets_Pagination')}">
                            <li>
                                <h:commandLink 
                                    id="resetPagination" 
                                    action="#{Metadaten.reloadPagination}">
                                    <i class="fa fa-refresh" aria-hidden="true"></i>
                                    #{msgs.mets_resetPagination}
                                    <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                    <f:passThroughAttribute name="data-placement" value="bottom" />
                                </h:commandLink>
                            </li>
                        </c:if>
                
                        <li>
                            <h:commandLink  
                                id="toggleTopstruct" 
                                action="#{Metadaten.changeTopstruct}">
                                <i class="fa fa-sitemap" aria-hidden="true"></i>
                                #{Metadaten.physicalTopstruct?msgs.showLogicalTree:msgs.showPhysicalTree}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                            </h:commandLink>
                        </li>
                
                        <li>
                            <h:commandLink 
                                id="toggleThumbLabel" 
                                action="#{NavigationForm.Reload}">
                                <i class="fa fa-file" aria-hidden="true"></i>
                                #{NavigationForm.uiStatus.mets_thumbFilename?msgs.mets_showThumbFileNames:msgs.mets_showThumbPagination}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{NavigationForm.uiStatus.mets_thumbFilename?false:true}"
                                    property="#{NavigationForm.uiStatus.mets_thumbFilename}" />
                            </h:commandLink>
                        </li>
                
                        <li>
                            <h:commandLink 
                                id="toggleHiddenFields" 
                                action="#{Metadaten.reloadMetadataList}">
                                <i class="fa fa-eye" aria-hidden="true"></i>
                                #{Metadaten.displayHiddenMetadata?msgs.mets_hideHiddenFields:msgs.mets_showHiddenFields}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                                <x:updateActionListener 
                                    value="#{!Metadaten.displayHiddenMetadata}"
                                    property="#{Metadaten.displayHiddenMetadata}" />
                            </h:commandLink>
                        </li>

                        <li class="seperator"></li>

                        <!-- DIRECTORIES -->
                        <ui:repeat var="directory" value="#{Metadaten.allTifFolders}">
                            <li>
                                <h:commandLink action="#{Metadaten.changeFolder}" styleClass="#{Metadaten.currentTifFolder == directory ? 'active':''}">
                                    <i class="fa fa-sitemap" aria-hidden="true"></i> 
                                    #{directory}
									<x:updateActionListener value="0" property="#{Metadaten.numberOfNavigation}" />
                                    <x:updateActionListener value="#{directory}" property="#{Metadaten.currentTifFolder}" />
                                    <f:ajax execute="@form" render="@form :openseadragonform :thumbnailsForm" />
								</h:commandLink>
                            </li>
                        </ui:repeat>
                    </ul>
                </li>

                <!-- SAVE -->
                <c:if test="#{not Metadaten.nurLesenModus}">
                    <li>                   
                        <h:commandLink  
                            id="saveMetsFileButton" 
                            action="#{Metadaten.Reload}" 
                            title="#{msgs.speichern}">
                            <i class="fa fa-floppy-o fa-lg" aria-hidden="true"></i>
                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                            <f:passThroughAttribute name="data-placement" value="bottom" />
                        </h:commandLink>

                        <h:panelGroup
                            style="display:none"
                            styleClass="navigationitem"
                            id="saveMetsFileImage">
                            <f:passThroughAttribute
                                name="data-placement"
                                value="bottom" />
                            <i class="fa fa-floppy-o"></i>
                        </h:panelGroup>

                        <h:commandButton
                            type="button"
                            id="saveMetsFileButtonAjax"
                            style="display:none"
                            action="#{Metadaten.Reload}"
                            title="#{msgs.speichern}"
                            rel="tooltip">
                            <f:ajax />
                            <f:passThroughAttribute
                                name="data-placement"
                                value="bottom" />

                        </h:commandButton>
                        <h:commandButton
                            type="button"
                            id="automaticSave"
                            style="display:none"
                            action="#{Metadaten.automaticSave}"
                            title="#{msgs.automaticSave}"
                            rel="tooltip">
                            <f:ajax render="@form"></f:ajax>
                            <f:passThroughAttribute
                                name="data-placement"
                                value="bottom" />

                        </h:commandButton>

                    </li>
                </c:if>

                <li>
                    <button 
                        type="button" 
                        class="btn btn--clean" 
                        title="#{msgs.mets_leaveMetsEditor}" 
                        data-show="submenu"
                        data-toggle="tooltip"
                        data-placement="bottom">
                        <i class="fa fa-home fa-lg" aria-hidden="true"></i>
                    </button>
                    <ul class="clean submenu">            
                        <c:if test="#{not Metadaten.nurLesenModus}">
                            <li>
                                <h:commandLink 
                                    id="saveAndExit" 
                                    action="#{Metadaten.XMLschreiben}"
                                    onclick="goobiWorkflowJS.displayProgressBar()">
                                    <i class="fa fa-floppy-o" aria-hidden="true"></i>
                                    #{msgs.speichernZurueck}
                                    <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                    <f:passThroughAttribute name="data-placement" value="bottom" />
                                </h:commandLink>
                            </li>
                        </c:if>

                        <li>
                            <h:commandLink 
                                id="exitOnly" 
                                action="#{Metadaten.goZurueck}"
                                rendered="#{!Metadaten.checkForNewerTemporaryMetadataFiles}">
                                <i class="fa fa-trash-o" aria-hidden="true"></i>
                                #{msgs.goBack}
                                <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                <f:passThroughAttribute name="data-placement" value="bottom" />
                            </h:commandLink>
                            <h:panelGroup rendered="#{Metadaten.checkForNewerTemporaryMetadataFiles}">
                                <button type="button" title="#{msgs.goBack}" data-toggle="modal" data-target="#unsavedChanges">
                                    <i class="fa fa-trash-o" aria-hidden="true"></i>
                                    #{msgs.goBack}
                                </button>            
                            </h:panelGroup>
                        </li>
                    </ul>
                </li>
            </ul>
        </h:form>
    </composite:implementation>
</ui:composition>