<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
    xmlns:p="http://primefaces.org/ui">

    <composite:interface />

    <composite:implementation>
        <ui:fragment rendered="#{Metadaten.modusStrukturelementVerschieben}">
            <div class="module module__box module__box--white module__box--collapsable structdata__change">
                <div class="module__box-title">
                    <h3>
                        <i class="fa fa-bars" aria-hidden="true"></i>
                        <span>#{msgs.docstructAnAndereStelleSchieben}</span>
                        <button type="button" class="btn btn--clean" data-toggle="box-body">
                            <i class="fa fa-angle-up fa-lg" aria-hidden="true"></i>
                        </button>
                    </h3>
                </div>
                <div class="module__box-body">
                    <p>
                        <h:outputText value="#{msgs.strukturelementVerschiebenErlaeuterung}" />
                    </p>
                
                    <hr />
                
                    <div class="table__structure">
                        <h:dataTable value="#{Metadaten.strukturBaum3Alle}" var="item">
                            <h:column styleClass="level-#{item.niveau}">
                                <i class="fa fa-file-o" aria-hidden="true"></i>
                    
                                <h:commandLink 
                                    id="moveNode" 
                                    styleClass="document" 
                                    action="#{Metadaten.KnotenVerschieben}"
                                    rendered="#{item.node.einfuegenErlaubt and not item.node.selected}">
                                    <h:outputText value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '') ? item.node.description : item.node.mainTitle}" />               
                    
                                    <x:updateActionListener property="#{Metadaten.modusStrukturelementVerschieben}" value="false" />
                                    <x:updateActionListener property="#{Metadaten.tempStrukturelement}" value="#{item.node.struct}" />
                    
                                    <f:passThroughAttribute name="data-trigger" value="hover" />
                                    <f:passThroughAttribute name="data-container" value="body" />
                                    <f:passThroughAttribute name="data-toggle" value="popover" />
                                    <f:passThroughAttribute name="data-placement" value="right" />
                                    <f:passThroughAttribute name="data-html" value="true" />
                                    <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                        #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                        &lt;&#47;ul&gt;" />
                                </h:commandLink>
                    
                                <h:panelGroup rendered="#{not item.node.einfuegenErlaubt || item.node.selected}">                    
                                    <h:outputText
                                        value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '')?item.node.description:item.node.mainTitle}"
                                        styleClass="#{item.node.selected ? 'selected' : ''}">
                    
                                        <f:passThroughAttribute name="data-trigger" value="hover" />
                                        <f:passThroughAttribute name="data-container" value="body" />
                                        <f:passThroughAttribute name="data-toggle" value="popover" />
                                        <f:passThroughAttribute name="data-placement" value="right" />
                                        <f:passThroughAttribute name="data-html" value="true" />
                                        <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                        #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                        #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                        &lt;&#47;ul&gt;" />
                                    </h:outputText>
                                </h:panelGroup>
                            </h:column>
                        </h:dataTable>
                    </div>
                
                    <hr />

                    <!-- ACTION -->
                    <div class="row">
                        <div class="col-auto mr-auto"></div>
                        <div class="col-auto">
                            <h:commandLink 
                                id="cancelMove" 
                                styleClass="btn btn--gray" 
                                immediate="true"
                                action="#{NavigationForm.Reload}">
                                <h:outputText value="#{msgs.abbrechen}" title="#{msgs.verschiebenAbbrechen}" />
                                <x:updateActionListener property="#{Metadaten.modusStrukturelementVerschieben}" value="false" />
                            </h:commandLink>
                        </div>
                    </div>
                </div>
            </div>
        </ui:fragment>
    </composite:implementation>
</ui:composition>