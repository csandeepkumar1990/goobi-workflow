<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
    xmlns:p="http://primefaces.org/ui">

    <composite:interface />

    <composite:implementation>    
        <ui:fragment rendered="#{Metadaten.modusCopyDocstructFromOtherProcess}">        
            <div id="meStructdataCopyOtherProcessBox" class="module module__box module__box--white module__box--collapsable structdata__copy-other-process">
                <div class="module__box-title">
                    <h3>
                        <i class="fa fa-bars" aria-hidden="true"></i>
                        <span>#{msgs.copyDocstructFromOtherProcess}</span>
                        <button type="button" class="btn btn--clean" data-toggle="box-body">
                            <i class="fa fa-angle-up fa-lg" aria-hidden="true"></i>
                        </button>
                    </h3>
                </div>
                <div class="module__box-body">
                    <ui:fragment rendered="#{!Metadaten.displayInsertion}">
                        <!-- SEARCH PROCESS -->
                        <h4>
                            <h:outputText value="#{msgs.findProcess}" />
                        </h4>
                        <p>
                            <h:outputText value="#{msgs.copyDocstructFromOtherProcessDescription1}" />
                        </p>

                        <div class="form-group form-group--flex">
                            <div class="row">
                                <div class="col-3">
                                    <h:outputText styleClass="form-group__label" value="#{msgs.title}:" />
                                </div>
                                <div class="col-9">
                                    <x:inputText 
                                        id="filterProcessTitle" 
                                        styleClass="form-control"
                                        value="#{Metadaten.filterProcessTitle}" />
                                </div>
                            </div>
                        </div>

                        <!-- ACTION -->
                        <div class="row">
                            <div class="col-auto mr-auto"></div>
                            <div class="col-auto">
                                <h:commandLink 
                                    id="cancelMove2"
                                    styleClass="btn btn--gray"
                                    action="#{NavigationForm.Reload}" 
                                    title="#{msgs.verschiebenAbbrechen}">
                                    <h:outputText value="#{msgs.abbrechen}" title="#{msgs.verschiebenAbbrechen}" />
                                    <x:updateActionListener property="#{Metadaten.modusCopyDocstructFromOtherProcess}" value="false" />
                                    <x:updateActionListener value="false" property="#{Metadaten.displayInsertion}" />
                                </h:commandLink>

                                <h:commandLink 
                                    id="filterProcess" 
                                    styleClass="btn btn--gray"
                                    action="#{Metadaten.filterMyProcess}">
                                    <i class="fa fa-search" aria-hidden="true"></i>
                                    <h:outputText value="#{msgs.findProcess}" />
                                </h:commandLink>                        
                            </div>
                        </div>
            
                        <!-- STRUCTURE TABLE -->
                        <ui:fragment rendered="#{Metadaten.filteredProcess != null}">
                            <hr />
            
                            <h:dataTable rendered="#{Metadaten.filteredProcess != null}" value="#{Metadaten.struktureTreeAsTableForFilteredProcess}"
                                var="item">
                                <h:column styleClass="level-#{item.niveau}">
                                    <i class="fa fa-file-o" aria-hidden="true"></i>
            
                                    <h:commandLink 
                                        id="updateSubNodes" 
                                        styleClass="document" 
                                        action="#{Metadaten.updateAllSubNodes}"
                                        rendered="#{item.node.einfuegenErlaubt}">           
            
                                        <h:outputText
                                            value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '')?item.node.description:item.node.mainTitle}"
                                            style="#{item.node.selected?'color:red;':''}" />
            
            
                                        <f:passThroughAttribute name="data-trigger" value="hover" />
                                        <f:passThroughAttribute name="data-container" value="body" />
                                        <f:passThroughAttribute name="data-toggle" value="popover" />
                                        <f:passThroughAttribute name="data-placement" value="right" />
                                        <f:passThroughAttribute name="data-html" value="true" />
                                        <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                    #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                    &lt;&#47;ul&gt;" />
                                        <x:updateActionListener property="#{item.node.selected}" value="#{!item.node.selected}" />
                                    </h:commandLink>
            
                                    <h:outputText rendered="#{!item.node.einfuegenErlaubt}"
                                        value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '')?item.node.description:item.node.mainTitle}">
            
                                        <f:passThroughAttribute name="data-trigger" value="hover" />
                                        <f:passThroughAttribute name="data-container" value="body" />
                                        <f:passThroughAttribute name="data-toggle" value="popover" />
                                        <f:passThroughAttribute name="data-placement" value="right" />
                                        <f:passThroughAttribute name="data-html" value="true" />
                                        <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                    #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                    #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                    &lt;&#47;ul&gt;" />
                                    </h:outputText>
                                </h:column>            
                            </h:dataTable>
            
                            <hr />

                            <div class="row">
                                <div class="col-auto mr-auto"></div>
                                <div class="col-auto">
                                    <h:commandLink 
                                        id="nextPage"    
                                        styleClass="btn btn--gray" 
                                        action="#{Metadaten.rememberFilteredProcessStruct}">
                                        <h:outputText value="#{msgs.weiter}" />
                                        <x:updateActionListener value="true" property="#{Metadaten.displayInsertion}" />
                                    </h:commandLink>
                                </div>
                            </div>
                        </ui:fragment>
                    </ui:fragment>
            
                    <!-- COPY INTO CURRENT STRUCTURE -->
                    <ui:fragment rendered="#{Metadaten.displayInsertion}">
                        <h4>
                            <h:outputText value="#{msgs.selectTarget}" />
                        </h4>
                        <p>
                            <h:outputText value="#{msgs.strukturelementVerschiebenErlaeuterung}" />
                        </p>
                        
                        <hr />
            
                        <h:dataTable rendered="#{Metadaten.filteredProcess != null}" value="#{Metadaten.strukturBaum3Alle}" var="item">
                            <h:column styleClass="level-#{item.niveau}">
                        
                                <i class="fa fa-file-o" aria-hidden="true"></i>
                        
                                <h:commandLink id="importFilteredProcessStruct" styleClass="document"
                                    action="#{Metadaten.importFilteredProcessStruct}"
                                    rendered="#{item.node.einfuegenErlaubt and not item.node.selected}" onclick="setScrollPosition();">
                        
                                    <h:outputText
                                        value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '')?item.node.description:item.node.mainTitle}"
                                        style="#{item.node.selected?'color:red;':''}" />
                        
                                    <f:passThroughAttribute name="data-trigger" value="hover" />
                                    <f:passThroughAttribute name="data-container" value="body" />
                                    <f:passThroughAttribute name="data-toggle" value="popover" />
                                    <f:passThroughAttribute name="data-placement" value="right" />
                                    <f:passThroughAttribute name="data-html" value="true" />
                                    <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                                        #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                                        #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                                        #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                                        #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                                        #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                                        #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                                        &lt;&#47;ul&gt;" />
                                    <x:updateActionListener property="#{Metadaten.modusCopyDocstructFromOtherProcess}" value="false" />
                                    <x:updateActionListener property="#{Metadaten.tempStrukturelement}" value="#{item.node.struct}" />
                                </h:commandLink>
                        
                                <h:panelGroup rendered="#{not item.node.einfuegenErlaubt || item.node.selected}">
                        
                                    <h:outputText
                                        value="#{not Metadaten.treeProperties.showtitle || (Metadaten.treeProperties.showtitle and item.node.mainTitle == '')?item.node.description:item.node.mainTitle}"
                                        style="#{item.node.selected ? 'selected' : ''}">
                        
                        
                                        <f:passThroughAttribute name="data-trigger" value="hover" />
                                        <f:passThroughAttribute name="data-container" value="body" />
                                        <f:passThroughAttribute name="data-toggle" value="popover" />
                                        <f:passThroughAttribute name="data-placement" value="right" />
                                        <f:passThroughAttribute name="data-html" value="true" />
                                        <f:passThroughAttribute name="data-content" value="&lt;ul class=&quot;metseditorpopup-ul&quot;&gt; 
                                                                                            #{item.node.mainTitle != null and item.node.mainTitle ne ''? ('&lt;li&gt;').concat(msgs.haupttitel).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.mainTitle).concat('&lt;&#47;li&gt;'):''}
                                                                                            #{item.node.identifier != null and item.node.identifier ne ''? ('&lt;li&gt;').concat(msgs.identifier).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.identifier).concat('&lt;&#47;li&gt;'):''}
                                                                                            #{item.node.firstImage != null and item.node.firstImage ne ''? ('&lt;li&gt;').concat(msgs.firstImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.firstImage).concat('&lt;&#47;li&gt;'):''}
                                                                                            #{item.node.lastImage != null and item.node.lastImage ne ''? ('&lt;li&gt;').concat(msgs.lastImage).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.lastImage).concat('&lt;&#47;li&gt;'):''}
                                                                                            #{item.node.partNumber != null and item.node.partNumber ne ''? ('&lt;li&gt;').concat(msgs.partNumber).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.partNumber).concat('&lt;&#47;li&gt;'):''}
                                                                                            #{item.node.dateIssued != null and item.node.dateIssued ne ''? ('&lt;li&gt;').concat(msgs.dateIssued).concat(': &lt;&#47;li&gt; &lt;li&gt;').concat(item.node.dateIssued).concat('&lt;&#47;li&gt;'):''}
                                                                                            &lt;&#47;ul&gt;" />
                                    </h:outputText>
                                </h:panelGroup>
                            </h:column>
                        </h:dataTable>
            
                        <hr />

                        <div class="row">
                            <div class="col-auto mr-auto"></div>
                            <div class="col-auto">
                                <!-- CANCEL -->
                                <h:commandLink 
                                    id="cancelImport" 
                                    styleClass="btn btn--gray"
                                    action="#{NavigationForm.Reload}" 
                                    value="#{msgs.abbrechen}">
                                    <x:updateActionListener property="#{Metadaten.modusCopyDocstructFromOtherProcess}" value="false" />
                                    <x:updateActionListener property="#{Metadaten.displayInsertion}" value="false" />
                                </h:commandLink>
                                <!-- BACK -->
                                <h:commandLink 
                                    id="goBack"
                                    styleClass="btn btn--gray" 
                                    action="#{NavigationForm.Reload}">
                                    <h:outputText value="#{msgs.zurueck}" />
                                    <x:updateActionListener value="false" property="#{Metadaten.displayInsertion}" />
                                </h:commandLink>                                
                            </div>
                        </div>
                    </ui:fragment>
                </div>
            </div>
        </ui:fragment>
    </composite:implementation>
</ui:composition>