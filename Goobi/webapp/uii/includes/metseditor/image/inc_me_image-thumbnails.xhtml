<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
    xmlns:p="http://primefaces.org/ui">

    <composite:interface />

    <composite:implementation>
        <h:panelGroup rendered="#{Metadaten.sizeOfImageList gt 0 and Metadaten.treeProperties.showThumbnails}">
            <h:form prependId="false" id="thumbnails">
                <div id="thumbnailContainer">
                    <div class="row">
                        <div class="thumbnail-view">
                            <div class="box-title image-navigation">
                                <f:subview id="top">
                                        <!-- <ui:include src="image/inc_me_image-thumbNavigation.xhtml" /> -->
    
                                    <!-- gehezu-Schaltknopf -->
                                    <h:panelGroup layout="block">
                                        <h:outputText value="#{msgs.geheZuBild}:"
                                            styleClass="margin-left-10 margin-right-10" title="#{msgs.geheZuImage}" />
    
                                        <p:autoComplete scrollHeight="300" id="jumpToImage" forceId="true"
                                            value="#{Metadaten.bildNummerGeheZuCompleteString}" styleClass="autocomplete"
                                            completeMethod="#{Metadaten.autocomplete}" autoHighlight="false"
                                            onkeypress="return submitEnter('top:loadThumbnails',event)" />
                                        <h:commandButton value="go" id="loadThumbnails"
                                            action="#{Metadaten.loadImageInThumbnailList}"
                                            style="margin-left:5px; display:none">
                                            <f:ajax execute="@form" render="@form" />
                                        </h:commandButton>
    
    
                                        <h:panelGroup
                                            rendered="#{Metadaten.sizeOfImageList gt 0 and Metadaten.treeProperties.showThumbnails}">
                                            <h:outputText value="#{msgs.sizeOfImages}:" styleClass="thumbdropdownLabel" />
                                            <h:selectOneMenu value="#{Metadaten.thumbnailSize}"
                                                styleClass="form-control thumbdropdown thumbnails"
                                                title="#{msgs.sizeOfImages}">
                                                <f:selectItem itemValue="100" itemLabel="100 px" />
                                                <f:selectItem itemValue="150" itemLabel="150 px" />
                                                <f:selectItem itemValue="200" itemLabel="200 px" />
                                                <f:selectItem itemValue="250" itemLabel="250 px" />
                                                <f:selectItem itemValue="300" itemLabel="300 px" />
                                                <f:selectItem itemValue="350" itemLabel="350 px" />
                                                <f:selectItem itemValue="400" itemLabel="400 px" />
                                                <f:selectItem itemValue="450" itemLabel="450 px" />
                                                <f:selectItem itemValue="500" itemLabel="500 px" />
                                            </h:selectOneMenu>
                                            <h:commandLink styleClass="btn font-size-s" title="#{msgs.uebernehmen}">
                                                <i class="fa fa-check-circle-o" />
                                            </h:commandLink>
    
                                            <h:outputText value="#{msgs.numberOfImages}:" styleClass="thumbdropdownLabel" />
                                            <h:selectOneMenu id="numberOfImages" value="#{Metadaten.numberOfImagesPerPage}"
                                                styleClass="form-control thumbdropdown" title="#{msgs.numberOfImages}">
                                                <f:selectItem itemValue="12" itemLabel="12" />
                                                <f:selectItem itemValue="24" itemLabel="24" />
                                                <f:selectItem itemValue="48" itemLabel="48" />
                                                <f:selectItem itemValue="96" itemLabel="96" />
                                            </h:selectOneMenu>
                                            <h:commandLink styleClass="btn font-size-s" title="#{msgs.uebernehmen}">
                                                <i class="fa fa-check-circle-o" />
                                            </h:commandLink>
                                        </h:panelGroup>
    
                                    </h:panelGroup>
                                </f:subview>
                            </div>
                        </div>
                    </div>
    
                    <!-- THUMBNAIL LIST -->
                    <div class="row image-navigation">
                        <div class="col-xs-12 no-padding">
                            <ui:repeat var="image" value="#{Metadaten.paginatorList}" varStatus="status" id="thumbnailGrid">
                                <div
                                    class="goobi-thumbnail #{Metadaten.image.imageName eq image.imageName ? 'img-active' : 'font-light'}">
                                    <div class="thumb" id="thumb_#{image.order}">
                                        <h:commandLink id="thumbnailImage"
                                            title="#{NavigationForm.uiStatus.mets_thumbFilename?image.tooltip:Metadaten.alleSeiten[image.order -1].label}"
                                            action="#{Metadaten.checkSelectedThumbnail(image.order -1)}"
                                            onclick="selectClickedThumbnail(this)">
                                            <ui:fragment rendered="#{image.type == 'image'}">
                                                <canvas class="thumb-canvas" data-image_small="#{image.thumbnailUrl}"
                                                    data-image_large="#{image.largeThumbnailUrl}"
                                                    title="#{NavigationForm.uiStatus.mets_thumbFilename?image.tooltip:Metadaten.alleSeiten[image.order -1].label}"
                                                    id="thumbnail-#{status.index}"></canvas>
                                            </ui:fragment>
                                            <ui:fragment rendered="#{image.type == 'object' or image.type == 'x3dom'}">
                                                <img class="thumbnail_placeholder"
                                                    src="#{HelperForm.servletPathWithHostAsUrl}/uii/template/img/goobi_3d_object_placeholder.png" />
                                            </ui:fragment>
                                            <ui:fragment
                                                rendered="#{image.type != 'image' and image.type != 'object' and  image.type != 'x3dom'}">
                                                <img class="thumbnail_placeholder"
                                                    src="#{HelperForm.servletPathWithHostAsUrl}/uii/template/img/thumbnail-placeholder.png" />
                                            </ui:fragment>
                                            <x:updateActionListener value="false"
                                                property="#{NavigationForm.uiStatus.mets_scrollToThumb}" />
                                            <x:updateActionListener value="#{image.order -1}"
                                                property="#{Metadaten.imageIndex}" />
                                            <f:ajax render=":metseditorPaginationForm :menu-form" execute="@form" />
                                        </h:commandLink>
                                    </div>
                                    <div class="goobi-thumbnail-caption">
                                        <h:outputText rendered="#{NavigationForm.uiStatus.mets_thumbFilename}"
                                            value="#{Metadaten.alleSeiten[image.order -1].label}" />
                                        <h:outputText rendered="#{not NavigationForm.uiStatus.mets_thumbFilename}"
                                            value="#{image.tooltip}" />
                                        <br />
                                        <h:outputText style="color:white;" value="__________________________" />
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </div>
    
                    <!-- THUMBNAIL NAVIGATION -->
                    <div class="row">
                        <f:subview id="bottom">
                            <!-- <ui:include src="thumbnavigation.xhtml" /> -->
                        </f:subview>
                    </div>
    
                    <script type="text/javascript">
    								// function scrollToThumbnail() {
    								// 	var thumb = $("#thumb_#{Metadaten.image.order}");
    								// 	var useScroll = document.getElementById('menu-form:scrollToThumb').value;
    								// 	var shallScroll = '#{NavigationForm.uiStatus.mets_scrollToThumb}';
    								// 	if (shallScroll == 'true' &amp;&amp; useScroll == "true") {
    								// 		if (thumb != null &amp;&amp; thumb.position() != null) {
    								// 			var thumbScroll = thumb.position().top;
    								// 			$(document).scrollTop(thumbScroll - 22);
    								// 		} else {
    								// 			$(document).scrollTop(0);
    								// 		}
    								// 	}
    								// }
    								// function freeJSResources() {

    								// }
                    </script>
                </div>
            </h:form>
        </h:panelGroup>
    </composite:implementation>
</ui:composition>