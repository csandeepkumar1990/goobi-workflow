<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
    xmlns:p="http://primefaces.org/ui">

    <composite:interface />

    <composite:implementation>
        <ui:fragment rendered="#{Metadaten.sizeOfImageList gt 0 and Metadaten.treeProperties.showThumbnails}">
            <h:form id="thumbnailsForm" prependId="false">
                <!-- THUMBNAILS NAVIGATION -->
                <ui:include src="inc_me_image-thumbNavigation.xhtml" />

                <!-- THUMBNAILS -->
                <div id="thumbnails" class="thumbnails">
                    <ui:repeat var="image" value="#{Metadaten.paginatorList}" varStatus="status" id="thumbnailGrid">
                        <div class="thumbnails__thumb #{Metadaten.image.imageName eq image.imageName ? 'active' : ''}">
                            <!-- THUMBNAIL IMAGE -->
                            <div id="thumb_#{image.order}" class="thumbnails__thumb-image">
                                <h:commandLink 
                                    id="thumbnailImage"
                                    title="#{NavigationForm.uiStatus.mets_thumbFilename?image.tooltip:Metadaten.alleSeiten[image.order -1].label}"
                                    action="#{Metadaten.checkSelectedThumbnail(image.order -1)}"
                                    onclick="selectClickedThumbnail(this)">
                                    <!-- IMAGE -->
                                    <ui:fragment rendered="#{image.type == 'image'}">
                                        <canvas                                             
                                            id="thumbnail-#{status.index}"
                                            class="thumbnails__thumb-canvas" 
                                            title="#{NavigationForm.uiStatus.mets_thumbFilename?image.tooltip:Metadaten.alleSeiten[image.order -1].label}"
                                            data-image_small="#{image.thumbnailUrl}"
                                            data-image_large="#{image.largeThumbnailUrl}"></canvas>
                                    </ui:fragment>
                                    <!-- 3D OBJECT -->
                                    <ui:fragment rendered="#{image.type == 'object' or image.type == 'x3dom'}">
                                        <img 
                                            class="thumbnails__thumb-placeholder"
                                            src="#{HelperForm.servletPathWithHostAsUrl}/uii/template/img/goobi_3d_object_placeholder.png" />
                                    </ui:fragment>
                                    <!-- PLACEHOLDER -->
                                    <ui:fragment rendered="#{image.type != 'image' and image.type != 'object' and  image.type != 'x3dom'}">
                                        <img 
                                            class="thumbnails__thumb-placeholder"
                                            src="#{HelperForm.servletPathWithHostAsUrl}/uii/template/img/thumbnail-placeholder.png" />
                                    </ui:fragment>
                                    <x:updateActionListener 
                                        value="false"
                                        property="#{NavigationForm.uiStatus.mets_scrollToThumb}" />
                                    <x:updateActionListener value="#{image.order -1}" property="#{Metadaten.imageIndex}" />
                                    <f:ajax render="@form" execute="@form" />
                                </h:commandLink>
                            </div>

                            <!-- THUMBNAIL CAPTION -->
                            <div class="thumbnails__thumb-caption">
                                <span>
                                    <h:outputText 
                                        rendered="#{NavigationForm.uiStatus.mets_thumbFilename}"
                                        value="#{Metadaten.alleSeiten[image.order -1].label}" />
                                    <h:outputText 
                                        rendered="#{not NavigationForm.uiStatus.mets_thumbFilename}"
                                        value="#{image.tooltip}" />
                                </span>

                                <hr />
                            </div>
                        </div>
                    </ui:repeat>
                </div>


                <div id="thumbnailContainer">
                    <!-- <div class="row">
                        <div class="thumbnail-view">
                            <div class="box-title image-navigation"> -->
                                <!-- <f:subview id="top"> -->
                                        
    
                                    <!-- gehezu-Schaltknopf -->
                                    <!-- <h:panelGroup layout="block">
                                        <h:outputText value="#{msgs.geheZuBild}:"
                                            styleClass="margin-left-10 margin-right-10" title="#{msgs.geheZuImage}" />
    
                                        <p:autoComplete scrollHeight="300" id="jumpToImage" forceId="true"
                                            value="#{Metadaten.bildNummerGeheZuCompleteString}" styleClass="autocomplete"
                                            completeMethod="#{Metadaten.autocomplete}" autoHighlight="false"
                                            onkeypress="return submitEnter('top:loadThumbnails',event)" />
                                        <h:commandButton value="go" id="loadThumbnails"
                                            action="#{Metadaten.loadImageInThumbnailList}"
                                            style="margin-left:5px; display:none">
                                            <f:ajax execute="@form" render="@form" />
                                        </h:commandButton>
    
    
                                        
    
                                    </h:panelGroup> -->
                                <!-- </f:subview> -->
                            <!-- </div>
                        </div>
                    </div> -->
    
                    <!-- THUMBNAIL LIST -->
                    <div class="row image-navigation">
                        <div class="col-xs-12 no-padding">
                            
                        </div>
                    </div>
    
                    <!-- THUMBNAIL NAVIGATION -->
                    <div class="row">
                        <f:subview id="bottom">
                            <!-- <ui:include src="thumbnavigation.xhtml" /> -->
                        </f:subview>
                    </div>
    
                    <script type="text/javascript">
    								// function scrollToThumbnail() {
    								// 	var thumb = $("#thumb_#{Metadaten.image.order}");
    								// 	var useScroll = document.getElementById('menu-form:scrollToThumb').value;
    								// 	var shallScroll = '#{NavigationForm.uiStatus.mets_scrollToThumb}';
    								// 	if (shallScroll == 'true' &amp;&amp; useScroll == "true") {
    								// 		if (thumb != null &amp;&amp; thumb.position() != null) {
    								// 			var thumbScroll = thumb.position().top;
    								// 			$(document).scrollTop(thumbScroll - 22);
    								// 		} else {
    								// 			$(document).scrollTop(0);
    								// 		}
    								// 	}
    								// }
    								// function freeJSResources() {

    								// }
                    </script>
                </div>
            </h:form>
        </ui:fragment>
    </composite:implementation>
</ui:composition>