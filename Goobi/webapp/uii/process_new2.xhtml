<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:of="http://omnifaces.org/functions"
	template="/uii/template/template.html"
	xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

	<ui:param name="myPageTitle" value="#{msgs.einenNeuenProzessAnlegen}" />

	<ui:define name="breadcrumb">
		<intranda:breadcrumb id="id2"
			label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}"
			action="index" navId="a0" />
		<intranda:breadcrumb id="templates" label="#{msgs.prozessvorlagen}"
			action="process_all" navId="a1" />
		<intranda:breadcrumb id="newProcess2"
			label="#{msgs.einenNeuenProzessAnlegen}" action="process_new2" />
		<intranda:breadcrumb id="templateName"
			label="#{ProzesskopieForm.prozessVorlage.titel}"
			action="process_new2" noSeparator="#{true}" />
	</ui:define>

	<ui:define name="info">
	</ui:define>

	<ui:define name="content">
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/template/js/openseadragon/openseadragon.min.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/template/js/openseadragon/openseadragon-viewerinputhook.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/template/js/q-promises/q.min.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/template/js/reactiveX/rx.lite.min.js"></script>
		<script src="template/js/imageView/imageView.image.js"></script>
		<script src="template/js/imageView/imageView.tileSourceResolver.js"></script>
		<script src="template/js/imageView/imageView.measures.js"></script>
		<script src="template/js/imageView/imageView.controls.js"></script>
		<script src="template/js/imageView/imageView.zoomSlider.js"></script>

		<style>
.grid-container {
	display: grid;
	grid-template-columns: 35% 65%;
	grid-template-rows: auto;
	justify-items: center;
}

.upload-area {
	padding-left: 15px;
	border-left: 2px solid #368ee0;
	width: 100%
}

.image-area {
	padding-right: 15px;
	width: 100%;
	display: flex;
	flex-wrap: wrap;
	justify-content: flex-start;
	align-content: stretch;
	display: flex;
}

.image-container {
	width: 300px;
	margin: 10px;
	position: relative;
	text-align: center;
}

.image {
	max-width: 300px;
	margin-top: 40px;
	margin-bottom: 90px;
}

#upload .ui-widget-content {
	border: none;
}

#upload .ui-widget-header {
	background: #fff none repeat scroll 0 0;
}

#upload .ui-fileupload-choose {
	background: #368ee0 none repeat scroll 0 0;
	color: #fff;
	text-shadow: none;
	border: 0 none;
	padding: 0.3em 1em;
	font-weight: 400;
}

#upload .ui-fileupload-buttonbar span.ui-button .ui-button-text {
	padding: 0.3em 1em;
}

#upload .ui-fileupload-buttonbar span.ui-button span.ui-button-icon-left{
	display: none;
}

#upload .ui-fileupload-files {
	width: 100%;
}

.ui-fileupload-content .ui-progressbar {
	width: 100px;
	height: 20px;
	margin: 0px;
}

#upload .ui-fileupload-files td:first-child {
	display: none;
}

#upload .ui-fileupload-preview {
	display: none;
}

.folderselection {
	width: 100%;
	position: absolute;
	bottom: 45px;
	text-align: left;
}

.folderselectiondropdown{
	display:inline; 
	width:265px; 
	text-align:left
}

.folderselectionbutton{
	margin-left:5px;
	margin-top: -3px;
	padding: 4px 9px;
}

.comment {
	width: 100%;
	position: absolute;
	bottom: 0px;
}

.commentField {
	resize: none;
  	overflow: auto;
}

</style>

		<main>
			<div class="row">
				<div class="col-sm-12 box box-color box-bordered">
					<div class="box-title">
						<h2>
							<i class="fa fa-tasks"></i>
							<h:outputText value="#{msgs.zusaetzlicheDetails}" />
						</h2>
					</div>
					<div class="box-content nopadding">

						<!-- form for all additional properties -->
						<h:form styleClass="form-horizontal form-bordered" id="myform">
							
							<!-- list of all additional properties -->
							<x:dataList var="item" id="properties"
								value="#{ProzesskopieForm.prozessKopie.eigenschaftenList}">
								<intranda:formInputText id="property" label="#{item.titel}"
									field="#{item.wert}"
									help="#{msgs[('help_import_').concat(item.titel)]}" name="id"
									fieldStyle="form-control" required="true" />
							</x:dataList>

							<!-- area for buttons to -->
							<div class="form-actions" style="border-bottom:1px solid #ddd">
								<!-- Save -->
								<h:commandLink
									styleClass="btn btn-success font-size-s pull-right"
									id="absenden" action="#{ProzesskopieForm.NeuenProzessAnlegen}">
									<i class="fa fa-save margin-right-5"></i>
									<h:outputText value="#{msgs.speichern}" />
								</h:commandLink>

								<!-- Cancel -->
								<h:commandLink id="cancel"
									styleClass="btn margin-sides-10 font-size-s pull-right"
									action="process_all" value="#{msgs.abbrechen}" immediate="true">
								</h:commandLink>

								<!-- Go back -->
								<h:commandLink styleClass="btn font-size-s" id="back"
									action="#{ProzesskopieForm.GoToSeite1}">
									<i class="fa fa-arrow-circle-o-left margin-right-5"></i>
									<h:outputText value="#{msgs.zurueck}" />
								</h:commandLink>
							</div>
						</h:form>
						<!-- // form for all additional properties -->

						<!-- form to allow the file upload -->
						<h:form id="uploadForm" enctype="multipart/form-data"
							rendered="#{ProzesskopieForm.standardFields.fileUpload}"
							styleClass="form-horizontal form-bordered" prependId="false">
							
							<!-- selection of the target folder -->
							<div class="form-group">
								<div class="col-sm-3 control-label" tabindex="-1">
									<h:outputLabel for="folderSelection" value="#{msgs.damageDocFolderSelection}" />
									<i class="fa fa-asterisk pull-right font-asterisk"/>
								</div>
								<div class="col-sm-9">
									<h:selectOneRadio id="folderSelection"
										value="#{ProzesskopieForm.uploadFolder}"
										disabledClass="margin-sides-10" enabledClass="margin-sides-10"
										tabindex="0">
										<f:selectItems value="#{ProzesskopieForm.configuredFolderNames}" />
										<f:ajax event="change" execute="@this" />
									</h:selectOneRadio>
									<h:outputText styleClass="help-block font-light" rendered="#{NavigationForm.showHelp}"
										value="#{msgs.helpDamageDocFolderSelection}" />
								</div>
							</div>
							<!-- // selection of the target folder -->
							
							<!-- define a default comment -->
							<intranda:formInputTextAjax id="defaultComment" label="#{msgs.damageDocDefaultComment}" 
								field="#{ProzesskopieForm.fileComment}" help="#{msgs.helpDamageDocDefaultComment}" 
								name="defaultComment" fieldStyle="form-control" required="false" ajaxevent="change" execute="@this"/>
							
							<!-- Upload of the files -->
							<div class="form-group">
								<div class="col-sm-3 control-label" tabindex="-1">
									<h:outputLabel for="uploadArea" value="#{msgs.damageDocFileUpload}" />
								</div>
								<div class="col-sm-9">
									<p:fileUpload
										fileUploadListener="#{ProzesskopieForm.uploadFile}"
										id="upload" auto="true"
										mode="advanced" multiple="true" dragDropSupport="true"
										label="#{msgs.plugin_massupload_selectFiles}"
										sizeLimit="1000000000000" fileLimit="42000"
										update=":imageform" />
									<h:outputText styleClass="help-block font-light" rendered="#{NavigationForm.showHelp}"
										value="#{msgs.helpDamageDocFileUpload}" />
								</div>
							</div>
							<!-- // Upload of the files -->
							
						</h:form>
						<!-- // form to allow the file upload -->


						<!-- form to show all uploaded images -->
						<h:form id="thumbsform" prependId="false" rendered="#{ProzesskopieForm.standardFields.fileUpload}">
							<h:panelGroup layout="block" styleClass="image-area"
								id="imageform">
								<ui:repeat var="image"
									value="#{ProzesskopieForm.uploadedImages}">

									<div class="image-container">
										<img class="image" alt="#{image.tooltip}" title="#{image.tooltip}"
											src="#{image.thumbnailUrl}" data-toggle="tooltip"/>
										<div class="folderselection">
											<h:selectOneMenu value="#{image.foldername}"
												styleClass="form-control folderselectiondropdown">
												<f:selectItems
													value="#{ProzesskopieForm.configuredFolderNames}" />
												<f:ajax event="change" execute="@this" />
											</h:selectOneMenu>
											<!-- delete file -->
											<h:commandLink styleClass="btn font-size-s folderselectionbutton" 
												action="#{ProzesskopieForm.uploadedImages.remove(image)}" 
												title="#{msgs.damageDocDeleteFile}">
												<i class="fa fa-trash "/>
												<f:passThroughAttribute name="data-toggle" value="tooltip" />
											</h:commandLink>
										</div>
										<div class="comment">
											<h:inputTextarea value="#{image.descriptionText}"
												styleClass="form-control commentField">
												<f:passThroughAttribute name="placeholder"
													value="#{msgs.damageDocComment}">
												</f:passThroughAttribute>
												<f:ajax event="change" execute="@this" />
											</h:inputTextarea>
										</div>
									</div>
								</ui:repeat>
							</h:panelGroup>
						</h:form>
					</div>
				</div>
			</div>

		</main>
	</ui:define>

</ui:composition>