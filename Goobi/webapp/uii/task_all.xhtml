<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
	xmlns:h="http://xmlns.jcp.org/jsf/html" 
	xmlns:f="http://xmlns.jcp.org/jsf/core" 
	xmlns:of="http://omnifaces.org/functions" 
	xmlns:c="http://java.sun.com/jsp/jstl/core" 
	template="/uii/template/template.html" 
	xmlns:x="http://myfaces.apache.org/tomahawk" 
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" 
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:jsf="http://xmlns.jcp.org/jsf">

    <ui:param name="myPageTitle" value="#{msgs.aktuelleSchritte}" />

    <ui:define name="breadcrumb">
        <intranda:breadcrumb id="index" label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}" action="index" navId="a0" />
        <intranda:breadcrumb id="taskAll" label="#{myPageTitle}" action="task_all" noSeparator="#{true}" />
    </ui:define>

    <ui:define name="info">
    </ui:define>
    <ui:define name="content">
	<main role="main">
		<c:if test="#{LoginForm.hasRole('Task_List')}">

        <div class="row">
            <div class="col-sm-12">
                <div class="box box-color box-bordered">
                    <div class="box-title">
                        <h2>
                            <i class="fa fa-list"></i>
                            <h:outputText value="#{myPageTitle}" />
                        </h2>
                    </div>
                    <div class="box-content nopadding">
                        <div class="dataTables_wrapper">
                            <h:form id="searchform">
                                <div class="dataTables_length" style="margin-bottom: 10px;">
                                    <h:outputText value="#{msgs.treffer}: #{AktuelleSchritteForm.paginator.totalResults}" />
                                </div>

                                <x:aliasBeansScope>
                                    <x:aliasBean alias="#{Form}" value="#{AktuelleSchritteForm}" />
                                    <x:aliasBean alias="#{label}" value="#{msgs.filterTasks}" />
                                    <ui:include src="includes/task/list_searchAndSave.xhtml" />
                                </x:aliasBeansScope>

                                <ui:include src="includes/task/list_filterAndDisplay.xhtml" />
                            </h:form>
                            <h:form id="myform" prependId="false">
                                <!-- Datentabelle -->
                                <x:dataTable id="tasks" styleClass="table table-hover table-nomargin dataTable table-bordered responsive" var="item" value="#{AktuelleSchritteForm.paginator.list}">

                                    <!-- +++++++++++++++++ select boxes ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{AktuelleSchritteForm.anzeigeAnpassen['selectionBoxes']}">
                                        <f:facet name="header">
                                            <x:div>
                                                <!-- Header -->
                                                <h:outputText value="#{msgs.auswahl2}" styleClass="" />
                                                <button class="button-no-style font-black" jsf:action="#{AktuelleSchritteForm.SelectionNone}" jsf:id="selectnone" title="#{msgs.auswahlEntfernen}">
                                                    <i class="fa fa-square-o" />
                                                </button>
                                                <button class="font-black" jsf:action="#{AktuelleSchritteForm.SelectionAll}" jsf:id="selectAll" title="#{msgs.alleAuswaehlen}">
                                                    <i class="fa fa-check-square-o" />
                                                </button>
                                            </x:div>
                                        </f:facet>
                                        <button jsf:id="selection" class="font-black" style="padding:10px">
                                            <i class="#{item.selected?'fa fa-check-square-o':'fa fa-square-o'}" />
                                            <f:setPropertyActionListener target="#{item.selected}" value="#{item.selected?false:true}" />
                                            <f:ajax render=":myform" />
                                        </button>
                                    </x:column>

                                    <!-- +++++++++++++++++  ProzessID ++++++++++++++++++++++++ -->
                                    <x:column id="my_tasks_process" rendered="#{AktuelleSchritteForm.anzeigeAnpassen['processId']}">
                                        <f:facet name="header">
                                            <button jsf:id="sortProcessId" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.id}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='idDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='idAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}"
                                                    value="#{AktuelleSchritteForm.sortierung=='idAsc'?'idDesc':'idAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>
                                        <h:outputText value="#{item.prozess.id}" />
                                    </x:column>
                                    
                                    <!-- +++++++++++++++++  Task ++++++++++++++++++++++++ -->
                                    <x:column>
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortStepTitle" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.arbeitsschritt}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='schrittDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='schrittAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='schrittAsc'?'schrittDesc':'schrittAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <ui:include src="includes/ajaxPlusMinusButtonTask.xhtml" />

                                        <h:panelGroup styleClass="margin-top-10 block" id="auflistungIntern" rendered="#{item.panelAusgeklappt}">

                                            <div class="box box-small box-color box-bordered">
                                                <div class="box-title">
                                                    <h3>
                                                        <i class="fa fa-table"></i>
                                                        #{msgs.details}
                                                    </h3>
                                                </div>
                                                <div class="box-content nopadding">
                                                    <h:panelGrid columns="2" class="table table-hover table-bordered">

                                                        <h:outputText value="#{msgs.titel}:" />
                                                        <h:outputText value="#{item.titelLokalisiert}" title="#{item.titel}"/>
                                                        <h:outputText value="#{msgs.bearbeitungsbeginn}:" rendered="#{item.bearbeitungsbeginn !=null and !HelperForm.anonymized}" />
                                                        <h:outputText value="#{item.bearbeitungsbeginnAsFormattedString}" rendered="#{item.bearbeitungsbeginn !=null and !HelperForm.anonymized}" >
<!--                                                         	<f:convertDateTime locale="#{SpracheForm.locale}" type="both" dateStyle="medium"/> -->
                                                        </h:outputText>
                                                        <h:outputText value="#{msgs.zuletztBearbeitet}:" rendered="#{item.bearbeitungszeitpunkt !=null and !HelperForm.anonymized}" />
                                                        <h:outputText value="#{item.bearbeitungszeitpunktAsFormattedString}" rendered="#{item.bearbeitungszeitpunkt !=null and !HelperForm.anonymized}" >
<!--                                                         	<f:convertDateTime locale="#{SpracheForm.locale}" type="both" dateStyle="medium"/> -->
                                                        </h:outputText>
                                                        <h:outputText value="#{msgs.letzteAktualisierungDurch}:" rendered="#{item.bearbeitungsbenutzer.id !=0 and item.bearbeitungsbenutzer !=null and !HelperForm.anonymized}" />
                                                        <h:outputText value="#{item.bearbeitungsbenutzer.nachVorname}" rendered="#{item.bearbeitungsbenutzer.id !=0 and item.bearbeitungsbenutzer !=null and !HelperForm.anonymized}" />
                                                        <h:outputText value="#{msgs.aktualisierungstyp}:" />
                                                        <h:outputText value="#{item.editTypeEnum.title}" />
                                                        <h:outputText value="#{msgs.typ}:" />
                                                        <h:panelGroup>
								                            <h:outputText styleClass="block" value="#{msgs.metadaten}" rendered="#{item.typMetadaten}" />
								                            <h:outputText styleClass="block" value="#{msgs.importMittelsFileUpload}" rendered="#{item.typImportFileUpload}" />
								                            <h:outputText styleClass="block" value="#{msgs.exportDMS}" rendered="#{item.typExportDMS}" />
								                            <h:outputText styleClass="block" value="#{msgs.schrittBeimAnnehmenAbschliessen}" rendered="#{item.typBeimAnnehmenAbschliessen}" />
								                            <h:outputText styleClass="block" value="#{msgs.beimAnnehmenModulStarten}" rendered="#{item.typBeimAnnehmenModul}" />
								                            <h:outputText styleClass="block" value="#{msgs.beimAnnehmenModulStartenUndSchrittAbschliessen}" rendered="#{item.typBeimAnnehmenModulUndAbschliessen}" />
								                            <h:outputText styleClass="block" value="#{msgs.imagesLesen}" rendered="#{item.typImagesLesen}" />
								                            <h:outputText styleClass="block" value="#{msgs.imagesSchreiben}" rendered="#{item.typImagesSchreiben}" />
								                            <h:outputText styleClass="block" value="#{msgs.beimAbschliessenVerifizieren}" rendered="#{item.typBeimAbschliessenVerifizieren}" />
								                            <h:outputText styleClass="block" value="#{msgs.automatischerSchritt}" rendered="#{item.typAutomatisch}" />
								                            <h:outputText styleClass="block" value="#{msgs.typScriptStep}" rendered="#{item.typScriptStep}" />
								                            <h:outputText styleClass="block" value="#{msgs.modulSchritt}: #{item.typModulName}" rendered="#{item.typModulName!=null and item.typModulName!=''}" />
								                            <h:outputText styleClass="block" value="#{msgs.stepPlugin}: #{item.stepPlugin}" rendered="#{item.stepPlugin!=null and item.stepPlugin!=''}" />
								                            <h:outputText styleClass="block" value="#{msgs.validationPlugin}" rendered="#{item.validationPlugin!=null and item.validationPlugin!=''}" />
								                            <h:outputText styleClass="block" value="#{msgs.timeDelayPlugin}" rendered="#{item.delayStep!=null and item.delayStep!='' and item.delayStep}" />
								                            <h:outputText styleClass="block" value="#{msgs.batchStep}" rendered="#{item.batchStep}" />
								                            <h:outputText styleClass="block" value="#{msgs.updateMetadataIndex}" rendered="#{item.updateMetadataIndex}" />
								                        </h:panelGroup>
                                                        
                                                    </h:panelGrid>

                                                </div>
                                            </div>

                                        </h:panelGroup>

                                    </x:column>

                                    <!-- ===================== Process ====================== -->

                                    <x:column styleClass="tableColumnMaxWidthLong">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortProcessTitle" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.prozessTitel}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='prozessDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='prozessAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='prozessAsc'?'prozessDesc':'prozessAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <!-- Bearbeiten-Schaltknopf: konkrete Prozesse -->
	                                        <button jsf:action="process_edit" class="button-no-style" jsf:rel="tooltip" jsf:id="edit1" aria-label="#{msgs.prozessBearbeiten}" title="#{msgs.prozessBearbeiten}" jsf:rendered="#{LoginForm.hasRole('Workflow_General_Details')}">
                                            <i class="fa fa-tasks margin-right-10 btn" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{ProzessverwaltungForm.myProzess}" value="#{item.prozess}" />
                                            <f:setPropertyActionListener target="#{ProzessverwaltungForm.modusAnzeige}" value="aktuell" />
                                            <f:setPropertyActionListener target="#{ProzessverwaltungForm.modusBearbeiten}" value="" />
                                        </button>
                                        <h:outputText value="#{item.prozess.titel}" title="#{item.prozess.titel}" />
                                    </x:column>
										
									<!-- +++++++++++++++++  Custom columns ++++++++++++++++++++++++ -->
									<c:forEach items="#{LoginForm.listOfCustomColumns}" var="var">
										<x:column>
											<f:facet name="header">
												<h:outputText value="#{msgs[fn:substring(var, fn:indexOf(var,'.') lt 0 ? 1 : fn:indexOf(var,'.') + 1, var.length() - fn.indexOf(var,'.') - 1)]}" />
											</f:facet>
											<h:outputText value="#{item.prozess.getReplacedVariable(var)}" />
										</x:column>
									</c:forEach>

                                    <!-- ===================== Process date ====================== -->
                                    <x:column rendered="#{AktuelleSchritteForm.anzeigeAnpassen['processDate']}">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortDate" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.vorgangsdatum}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='prozessdateDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='prozessdateAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='prozessdateAsc'?'prozessdateDesc':'prozessdateAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <h:outputText value="#{item.prozess.erstellungsdatum}" />
                                    </x:column>

                                    <!-- ===================== Modules / Plugins ====================== -->
                                    <x:column rendered="#{AktuelleSchritteForm.anzeigeAnpassen['modules']}">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortModule" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.module}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='modulesDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='modulesAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='modulesAsc'?'modulesDesc':'modulesAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <h:outputText value="#{item.typModulName}" />
                                    </x:column>

                                    <!-- ===================== Project ====================== -->
                                    <x:column >
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortProject" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.projekt}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='projektDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='projektAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='projektAsc'?'projektDesc':'projektAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <h:outputText value="#{item.prozess.projekt.titel}" />
                                    </x:column>
                                    <x:column styleClass="tableColumnOverflow maxWidth120"
                                        rendered="#{AktuelleSchritteForm.anzeigeAnpassen['institution']}">
                                            <f:facet name="header">
                                                <!-- Header -->
                                                <button class="button-no-style font-black-block" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}"
                                                    title="#{msgs.institution}">
                                                    <h:outputText value="#{msgs.institution}"/>
                                                    <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='institutionDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='institutionAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                    <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}"
                                                        value="#{AktuelleSchritteForm.sortierung=='institutionAsc'?'institutionDesc':'institutionAsc'}" />
                                                    <f:ajax render=":myform" />
                                                </button>
                                            </f:facet>
                                            <h:outputText value="#{item.prozess.projekt.institution.shortName}" />
                                        </x:column>
                                    <!-- ===================== Lockings ====================== -->
                                    <x:column rendered="#{AktuelleSchritteForm.anzeigeAnpassen['lockings']}">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortLocking" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.sperrungen}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='sperrungenDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='sperrungenAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='sperrungenAsc'?'sperrungenDesc':'sperrungenAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <h:outputText value="#{item.prozess.benutzerGesperrt.nachVorname}" rendered="#{item.prozess.benutzerGesperrt != null}" />
                                    </x:column>

                                    <!-- ===================== Batch ====================== -->
                                    <x:column rendered="#{AktuelleSchritteForm.anzeigeAnpassen['batchId']}">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button type="button" jsf:id="sortBatch" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.batch}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='batchDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='batchAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='batchAsc'?'batchDesc':'batchAsc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>
                                        <h:outputText value="#{item.prozess.batch.batchId}" rendered="#{item.prozess.batch != null}"/>
                                        <h:outputText value=" (#{item.prozess.batch.batchName})" rendered="#{item.prozess.batch != null and item.prozess.batch.batchName != null}"/>
                                    </x:column>

                                    <!-- ===================== Status ====================== -->
                                    <x:column>
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <h:outputText value="#{msgs.prioritaet}" />
                                        </f:facet>

										<h:panelGroup rendered="#{item.prioritaet == 0}" class="badge badge-intranda-ultralight">
 											<h:outputText value="#{msgs.normalePrioritaet}" />
										</h:panelGroup>
										
                                        <h:panelGroup rendered="#{item.prioritaet == 1}" class="badge badge-intranda-orange">
                                            <i class="fa fa-lightbulb-o"></i>
												#{msgs.badgePriority1}
										</h:panelGroup>
										
                                        <h:panelGroup rendered="#{item.prioritaet == 2}" class="badge badge-intranda-orange">
                                            <i class="fa fa-lightbulb-o" />
												#{msgs.badgePriority2}
                                        </h:panelGroup>


                                        <h:panelGroup rendered="#{item.prioritaet gt 2 and item.prioritaet lt 10}" class="badge badge-intranda-orange">
                                            <i class="fa fa-lightbulb-o"></i>
												#{msgs.badgePriority3}
                                        </h:panelGroup>

                                        <h:panelGroup styleClass="popover-div" style="display:none;" rendered="#{false}">
	                                            <ui:repeat var="intern" value="#{item.eigenschaftenList}" rendered="#{item.eigenschaftenSize!=0}" id="propList">
                                                <span class="block margin-bottom-10">
                                                    <i class="btn btn-red margin-right-10 fa fa-bullhorn fa-lg width-40"></i>
                                                    <h:outputText class="font-red" value="#{intern.titel}" />
                                                    <h:outputText class="block margin-top-5" value="#{intern.wert}" />
                                                </span>
                                            </ui:repeat>
                                        </h:panelGroup>

                                        <!-- Popup -->
                                        <x:popup id="popup" closePopupOnExitingElement="true" closePopupOnExitingPopup="true" displayAtDistanceX="-320" displayAtDistanceY="-160" rendered="#{item.prioritaet gt 9}">

                                            <f:facet name="popup">

                                                <div class="box box-small box-color red box-bordered">
                                                    <div class="box-title">
                                                        <h3>
                                                            <i class="fa fa-bullhorn"></i>
                                                            #{msgs.badgeCorrection}
                                                        </h3>
                                                    </div>
                                                    <div class="box-content nopadding">
                                                        <x:dataTable var="intern" style="width:400px" rendered="#{item.eigenschaftenSize!=0}" value="#{item.eigenschaftenList}" styleClass="table table-hover table-bordered">
                                                            <x:column style="vertical-align: top;">
                                                                <h:outputText value="#{intern.titel}:" />
                                                            </x:column>
                                                            <x:column style="vertical-align: top;">
                                                                <h:outputText value="#{intern.wert}" />
                                                            </x:column>
                                                        </x:dataTable>

                                                    </div>
                                                </div>

                                            </f:facet>
                                            <h:panelGroup class="badge badge-intranda-red">
                                                <i class="fa fa-bullhorn"></i>
													#{msgs.badgeCorrection}
                                            </h:panelGroup>
                                        </x:popup>
                                        
                                    </x:column>

                                    <!-- ===================== Action ====================== -->
                                    <x:column style="max-width:60px;" 
                                    >
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <button jsf:id="sortStatus" class="font-black-block button-link button-sort" jsf:action="#{AktuelleSchritteForm.FilterAlleStart}">
                                                <h:outputText styleClass="pull-left" value="#{msgs.auswahl}" />
                                                <span class="pull-right table-sort-icon fa #{AktuelleSchritteForm.sortierung=='statusDesc'?'fa-sort-desc':AktuelleSchritteForm.sortierung=='statusAsc'?'fa-sort-asc':'fa-sort'}"></span>
                                                <f:setPropertyActionListener target="#{AktuelleSchritteForm.sortierung}" value="#{AktuelleSchritteForm.sortierung=='statusDesc'?'statusAsc':'statusDesc'}" />
                                                <f:ajax render=":myform" />
                                            </button>
                                        </f:facet>

                                        <!-- Bearbeitung übernehmen-Schaltknopf -->
                                        <button jsf:id="take" aria-label="#{msgs.bearbeitungDiesesSchrittsUebernehmen}" class="btn btn-primary" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.SchrittDurchBenutzerUebernehmen}" jsf:rendered="#{(item.bearbeitungsstatusEnum == 'OPEN' and !item.batchStep) or (item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and !item.batchSize)}" title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
                                            <i class="fa fa-check"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>

                                        <button class="btn btn-red" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.SchrittDurchBenutzerUebernehmen}" jsf:rendered="#{(item.bearbeitungsstatusEnum == 'ERROR' and !item.batchStep) or (item.bearbeitungsstatusEnum == 'ERROR' and item.batchStep and !item.batchSize)}" title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
                                            <i class="fa fa-check"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>


                                        <!-- Bearbeiten-Schaltknopf (eigener Schritt) -->
                                        <button jsf:action="#{AktuelleSchritteForm.EditStep}" jsf:id="view1" aria-label="#{msgs.diesenSchrittBearbeiten}" class="btn btn-warning" jsf:rel="tooltip" jsf:rendered="#{(item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and !item.batchStep) or (item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and !item.batchSize)}" title="#{msgs.inBearbeitungDurch}: #{item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname:''}">
                                            <i class="fa fa-cog"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>

                                        <!-- Bearbeiten-Schaltknopf (fremder Schritt) -->
                                        <button jsf:action="#{AktuelleSchritteForm.EditStep}" jsf:id="view2" aria-label="#{msgs.diesenSchrittBearbeiten}" class="btn" jsf:rel="tooltip" jsf:rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and (!item.batchStep or !item.batchSize)}" title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
                                            <i class="fa fa-cog" style="color:#aaaaaa"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>

                                        <!-- edit batch step -->
                                        <button jsf:id="batch" class="btn btn-primary" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.TakeOverBatch}" jsf:rendered="#{item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and item.batchSize}" title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
                                            <i class="fa fa-check" style="margin-left: -6px"></i>
                                            <i class="fa fa-check" style="margin-left: -5px; margin-right: -6px"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>
                                        
                                        <!-- edit batch step -->
                                        <button jsf:id="batch-error" class="btn btn-red" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.TakeOverBatch}" jsf:rendered="#{item.bearbeitungsstatusEnum == 'ERROR' and item.batchStep and item.batchSize}" title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
                                            <i class="fa fa-check" style="margin-left: -6px"></i>
                                            <i class="fa fa-check" style="margin-left: -5px; margin-right: -6px"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>

                                        <!-- edit batch step -->
                                        <button jsf:id="batchInWork" class="btn btn-warning" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.BatchesEdit}" jsf:rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and item.batchSize}" title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
                                            <i class="fa fa-cogs"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>

                                        <!-- edit batch step -->
                                        <button jsf:id="batchInWorkOther" class="btn" jsf:rel="tooltip" jsf:action="#{AktuelleSchritteForm.BatchesEdit}" jsf:rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and item.batchStep and item.batchSize}" title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
                                             <i class="fa fa-cogs" style="color:#aaaaaa"></i>
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
                                        </button>
                                        
<!--                                       	<h:panelGroup rendered="#{item.bearbeitungsstatusEnum.title eq 'statusError'}"> -->
<!--                                             <i class="fa fa-life-ring font-red pull-right" style="font-size:30px;"/> -->
<!--                                         </h:panelGroup> -->
                                    </x:column>
                                    <!-- ===================== // Action ====================== -->

                                </x:dataTable>


                                <div class="dataTables_paginate">
                                    <!-- paginator -->
                                    <intranda:tablePaginator id="steps" paginator="#{AktuelleSchritteForm.paginator}" />
                                    <!-- /paginator -->
                                </div>

                            </h:form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h:form id="actionform">
            <h:panelGroup rendered="#{LoginForm.myBenutzer.mitMassendownload  and AktuelleSchritteForm.paginator.totalResults > 0 }">
                <div class="row">
                    <div class="col-sm-12">

                        <div class="box box-color orange box-bordered">
                            <div class="box-title">
                                <h3>
                                    <i class="fa fa-wrench"></i>
                                    <h:outputText value="#{msgs.moeglicheAktionen}" />
                                </h3>
                            </div>
                            <div class="box-content">

                                <h:panelGroup styleClass="pull-right">
                                    <h:outputText value="#{msgs.anzahlDerImagesAllerTreffer}:" />
                                    <h:outputText id="calcNumber" styleClass="margin-left-5 margin-right-5" value="#{AktuelleSchritteForm.allImages}" />
                                    <button jsf:id="calc" jsf:action="#{AktuelleSchritteForm.calcHomeImages}" class="btn">
                                        <i class="fa fa-refresh" />
                                    </button>
                                </h:panelGroup>

                                <ul class="action-ul">
                                    <li class="action-li">
                                        <button jsf:id="uploadAll" jsf:action="#{AktuelleSchritteForm.UploadFromHomeAlle}" class="btn btn-lightred" title="#{msgs.verzeichnisFertigHochladen}" onclick="if (!confirm('#{msgs.upload}')) return false">
                                            <span class="margin-right-10 fa fa-cloud-upload fa-lg" />
                                            <h:outputText value="#{msgs.verzeichnisFertigHochladen}" />
                                        </button>
                                    </li>
                                    <li class="action-li">
                                        <button jsf:id="downloadPage" jsf:action="#{AktuelleSchritteForm.DownloadToHomePage}" class="btn btn-green" title="#{msgs.alleTrefferDieserSeiteInMeinHomeverzeichnis}" onclick="if (!confirm('#{msgs.upload}')) return false">
                                            <span class="margin-right-10 fa fa-cloud-download fa-lg" />
                                            <h:outputText value="#{msgs.alleTrefferDieserSeiteInMeinHomeverzeichnis}" />
                                        </button>
                                    </li>
                                    <li class="action-li">
                                        <button jsf:id="downloadAll" jsf:action="#{AktuelleSchritteForm.DownloadToHomeHits}" class="btn btn-green" title="#{msgs.gesamtesTreffersetInMeinHomeverzeichnis}" onclick="if (!confirm('#{msgs.upload}')) return false">
                                            <span class="margin-right-10 fa fa-cloud-download fa-lg" />
                                            <h:outputText value="#{msgs.gesamtesTreffersetInMeinHomeverzeichnis}" />
                                        </button>
                                    </li>
                                </ul>


                            </div>
                        </div>
                    </div>
                </div>
            </h:panelGroup>

        </h:form>

        <script type="text/javascript">
									$('.popover-jsf')
											.popover(
													{
														html : true,
														title : "#{msgs.badgeCorrection}",
														trigger : 'hover',
														placement : 'left',
														content : function() {
															return $(this)
																	.next(
																			'.popover-div')
																	.html();
														}
													});
								</script>
		</c:if>
	</main>
    </ui:define>
</ui:composition>
