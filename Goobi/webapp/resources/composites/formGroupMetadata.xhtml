<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:jsf="http://xmlns.jcp.org/jsf">

    <composite:interface>
        <composite:attribute name="metadata" />
        <composite:attribute name="person" />
        <composite:attribute
            name="cols"
            default="3" />
        <composite:attribute
            name="required"
            default="false" />
        <composite:attribute
            name="renderDuplicate"
            default="true" />
        <composite:attribute
            name="renderDelete"
            default="true" />
    </composite:interface>

    <composite:implementation>
        <!-- FORM GROUP METADATA -->
        <div class="form-group form-group--flex">
            <div class="row justify-content-between">
                <!-- LABEL -->
                <div class="col-3">
                    <h:outputText
                        styleClass="form-group__label"
                        value="#{cc.attrs.metadata.typ}:"
                        title="#{cc.attrs.metadata.md.type.name}" />
                </div>
                <!-- INPUT -->
                <div class="#{cc.attrs.cols eq 2 ? 'col-9' : 'col-7'}">
                    <!-- TEXT INPUT -->
                    <x:inputText
                        id="inputText"
                        pt:aria-label="#{cc.attrs.metadata.md.type.name}"
                        styleClass="form-control"
                        value="#{cc.attrs.metadata.value}"
                        disabled="#{cc.attrs.metadata.disableMetadataField}"
                        readonly="#{Metadaten.nurLesenModus}"
                        rendered="#{cc.attrs.metadata.outputType == 'input' or cc.attrs.metadata.outputType == 'geonames' or 
                        cc.attrs.metadata.outputType == 'gnd' or cc.attrs.metadata.outputType == 'dante' or cc.attrs.metadata.outputType == 'viaf' 
                        or cc.attrs.metadata.outputType == 'easydb' or cc.attrs.metadata.outputType == 'vocabularySearch'}">
                        <f:ajax
                            execute="@form"
                            event="valueChange" />
                    </x:inputText>

                    <!-- TEXT INPUT READ ONLY -->
                    <x:inputText
                        id="inputTextRO"
                        pt:aria-label="#{cc.attrs.metadata.md.type.name}"
                        styleClass="form-control"
                        disabled="true"
                        readonly="true"
                        value="#{cc.attrs.metadata.value}"
                        rendered="#{(cc.attrs.metadata.outputType == 'readonly')}" />

                    <!-- TEXTAREA -->
                    <x:inputTextarea
                        id="textarea"
                        pt:aria-label="#{cc.attrs.metadata.md.type.name}"
                        styleClass="form-control"
                        value="#{cc.attrs.metadata.value}"
                        disabled="#{cc.attrs.metadata.disableMetadataField}"
                        readonly="#{Metadaten.nurLesenModus}"
                        rendered="#{cc.attrs.metadata.outputType == 'textarea'}">
                        <f:ajax
                            execute="@form"
                            event="valueChange" />
                    </x:inputTextarea>

                    <!-- TEXTAREA FOR HTML -->
                    <x:inputTextarea
                        id="textareaHtml"
                        styleClass="form-control textarea-html"
                        value="#{cc.attrs.metadata.value}"
                        disabled="#{cc.attrs.metadata.disableMetadataField}"
                        readonly="#{Metadaten.nurLesenModus}"
                        rendered="#{cc.attrs.metadata.outputType == 'htmlInput'}">
                        <f:ajax
                            execute="@form"
                            event="valueChange" />
                    </x:inputTextarea>

                    <!-- SELECT -->
                    <ui:fragment rendered="#{(cc.attrs.metadata.outputType == 'select1')}">
                        <div class="form-control form-control--select">
                            <h:selectOneMenu
                                id="select"
                                styleClass="focusable"
                                pt:aria-label="#{msgs.selectionList}"
                                value="#{cc.attrs.metadata.selectedItem}"
                                disabled="#{cc.attrs.metadata.disableMetadataField}"
                                readonly="#{Metadaten.nurLesenModus}">
                                <f:selectItems
                                    value="#{cc.attrs.metadata.items}"
                                    itemValue="#{element.label}"
                                    var="element"
                                    itemLabel="#{element.label}" />
                                <f:ajax
                                    execute="@form"
                                    event="valueChange" />
                            </h:selectOneMenu>
                        </div>
                    </ui:fragment>

                    <ui:fragment rendered="#{(cc.attrs.metadata.outputType == 'vocabularyList')}">
                        <div class="form-control form-control--select">
                            <h:selectOneMenu
                                id="selectVocabularyList"
                                styleClass="focusable"
                                pt:aria-label="#{cc.attrs.metadata.md.type.name}"
                                value="#{cc.attrs.metadata.selectedItem}"
                                disabled="#{cc.attrs.metadata.disableMetadataField}"
                                readonly="#{Metadaten.nurLesenModus}">
                                <f:selectItems
                                    value="#{cc.attrs.metadata.possibleItems}"
                                    itemValue="#{element.label}"
                                    var="element"
                                    itemLabel="#{element.value}" />
                                <f:ajax
                                    execute="@form"
                                    event="valueChange" />
                            </h:selectOneMenu>
                        </div>
                    </ui:fragment>

                    <!-- MULTISELECT -->
                    <h:selectManyListbox
                        id="multiSelect"
                        pt:aria-label="#{cc.attrs.metadata.md.type.name}"
                        styleClass="form-control"
                        value="#{cc.attrs.metadata.selectedItems}"
                        disabled="#{cc.attrs.metadata.disableMetadataField}"
                        rendered="#{(cc.attrs.metadata.outputType == 'select')}"
                        readonly="#{Metadaten.nurLesenModus}">
                        <f:selectItems
                            value="#{cc.attrs.metadata.items}"
                            itemValue="#{element.label}"
                            var="element"
                            itemLabel="#{element.label}" />
                        <f:ajax
                            execute="@form"
                            event="valueChange" />
                    </h:selectManyListbox>

                    <!-- AUTHORITY DATA - NO DANTE, VIAF OR EASYDB -->
                    <ui:fragment rendered="#{cc.attrs.metadata.normdata and cc.attrs.metadata.outputType != 'dante' and cc.attrs.metadata.outputType != 'viaf' and cc.attrs.metadata.outputType != 'easydb' and cc.attrs.metadata.outputType != 'vocabularySearch'}">
                        <div class="form-group form-group--inside">
                            <div class="row">
                                <div class="col-4">
                                    <div class="form-control form-control--select">
                                        <h:selectOneMenu
                                            id="selectNoDante"
                                            styleClass="focusable"
                                            pt:aria-label="#{msgs.erscheinungsort}"
                                            disabled="#{cc.attrs.metadata.disableIdentifierField or (cc.attrs.metadata.outputType == 'readonly')}"
                                            value="#{cc.attrs.metadata.normDatabase}"
                                            readonly="#{Metadaten.nurLesenModus}">
                                            <f:selectItems
                                                value="#{cc.attrs.metadata.possibleDatabases}"
                                                var="database"
                                                itemLabel="#{database}"
                                                itemValue="#{database}" />
                                            <f:ajax
                                                execute="@form"
                                                event="valueChange" />
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div
                                    class="col"
                                    style="padding-left: 0px;">
                                    <h:inputText
                                        id="inputTextNoDante"
                                        pt:aria-label="#{msgs.erscheinungsort}"
                                        styleClass="form-control"
                                        disabled="#{cc.attrs.metadata.disableIdentifierField or (cc.attrs.metadata.outputType == 'readonly')}"
                                        value="#{cc.attrs.metadata.normdataValue}"
                                        readonly="#{Metadaten.nurLesenModus}">
                                        <f:ajax
                                            execute="@form"
                                            event="valueChange" />
                                    </h:inputText>
                                </div>
                            </div>
                        </div>
                    </ui:fragment>
                    <!-- AUTHORITY DATA - DANTE, VIAF AND EASYDB -->
                    <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'dante' or cc.attrs.metadata.outputType == 'viaf' or cc.attrs.metadata.outputType == 'easydb' or cc.attrs.metadata.outputType == 'vocabularySearch'}">
                        <h:inputText
                            id="danteValue"
                            pt:aria-label="#{msgs.mets_authority_data}"
                            styleClass="form-control"
                            disabled="#{cc.attrs.metadata.disableIdentifierField}"
                            value="#{cc.attrs.metadata.normdataValue}"
                            readonly="#{Metadaten.nurLesenModus}">
                            <f:ajax
                                execute="@form"
                                event="valueChange" />
                        </h:inputText>
                    </ui:fragment>
                </div>
                <!-- ACTIONS -->
                <ui:fragment rendered="#{cc.attrs.cols eq 3}">
                    <div class="btn-area duplicate">
                        <!-- DELETE -->
                        <button
                            class="btn btn--icon-light"
                            jsf:id="actionDelete"
                            aria-label="#{msgs.DELETE_CURRENT_METADATA}"
                            tabindex="0"
                            jsf:action="#{Metadaten.Loeschen}"
                            title="#{msgs.metadatenLoeschen}"
                            jsf:rendered="#{cc.attrs.metadata.outputType != 'readonly' and cc.attrs.renderDelete == 'true'}">
                            <i
                                class="fa fa-lg fa-trash-o"
                                aria-hidden="true"></i>
                            <x:updateActionListener
                                property="#{Metadaten.curMetadatum}"
                                value="#{cc.attrs.metadata}" />
                            <f:param
                                name="ID"
                                value="#{cc.attrs.metadata.identifier}" />
                            <f:passThroughAttribute
                                name="data-toggle"
                                value="tooltip" />
                            <f:passThroughAttribute
                                name="data-placement"
                                value="top" />
                            <f:ajax
                                execute="@form"
                                render="@form" />
                        </button>

                        <!-- COPY -->
                        <button
                            class="btn btn--icon-light"
                            jsf:id="actionCopy"
                            aria-label="#{msgs.metadatenKopieren}"
                            tabindex="0"
                            jsf:action="#{Metadaten.Kopieren}"
                            title="#{msgs.metadatenKopieren}"
                            jsf:rendered="#{cc.attrs.renderDuplicate and cc.attrs.metadata.outputType != 'readonly' and Metadaten.isAddableMetadata(cc.attrs.metadata.md.type)}">
                            <i
                                class="fa fa-lg fa-copy"
                                aria-hidden="true"></i>
                            <x:updateActionListener
                                property="#{Metadaten.curMetadatum}"
                                value="#{cc.attrs.metadata}" />
                            <f:param
                                name="ID"
                                value="#{cc.attrs.metadata.identifier}" />
                            <f:passThroughAttribute
                                name="data-toggle"
                                value="tooltip" />
                            <f:passThroughAttribute
                                name="data-placement"
                                value="top" />
                            <f:ajax
                                execute="@form"
                                render="@form" />
                        </button>

                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'geonames'}">
                            <h:commandLink
                                styleClass="change-icon geonamesIndexTrigger"
                                title="#{msgs.NORM_geonamesSearch}"
                                pt:aria-label="#{msgs.NORM_geonamesSearch}"
                                onclick="$('#geonamesSearchBox').modal('show');">
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="GeoNames"
                                    src="template/img/Icons_GeoNames_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="GeoNames"
                                    src="template/img/Icons_GeoNames_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":geonamesModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>

                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'gnd'}">
                            <h:commandLink
                                styleClass="change-icon gndIndexTrigger"
                                title="#{msgs.NORM_gndSearch}"
                                pt:aria-label="#{msgs.NORM_gndSearch}"
                                onclick="$('#gndSearchBox').modal('show');">

                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="GND"
                                    src="template/img/Icons_GND_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="GND"
                                    src="template/img/Icons_GND_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":gndModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>

                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'process'}">
                            <h:commandLink
                                styleClass="change-icon processIndexTrigger"
                                title="#{msgs.NORM_processesSearch}"
                                pt:aria-label="#{msgs.NORM_processesSearch}"
                                onclick="$('#processesSearchBox').modal('show');">
                                <i
                                    class="fa fa-search"
                                    style="margin-left: 3px" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":processModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>

                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'dante'}">
                            <h:commandLink
                                styleClass="change-icon danteIndexTrigger"
                                title="#{msgs.NORM_danteSearch}"
                                pt:aria-label="#{msgs.NORM_danteSearch}"
                                onclick="$('#danteSearchBox').modal('show');">
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="Dante"
                                    src="template/img/Icons_Dante_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="Dante"
                                    src="template/img/Icons_Dante_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":danteModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>

                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'easydb'}">
                            <h:commandLink
                                styleClass="change-icon easydbIndexTrigger"
                                title="#{msgs.NORM_easydbSearch}"
                                pt:aria-label="#{msgs.NORM_easydbSearch}"
                                onclick="$('#easydbSearchBox').modal('show');">
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="EasyDB"
                                    src="template/img/Icons_easydb_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="EasyDB"
                                    src="template/img/Icons_easydb_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":easydbModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>
                        
                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'viaf'}">
                            <h:commandLink
                                styleClass="change-icon viafIndexTrigger"
                                title="#{msgs.NORM_viafSearch}"
                                pt:aria-label="#{msgs.NORM_viafSearch}"
                                onclick="$('#viafSearchBox').modal('show');">

                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="VIAF"
                                    src="template/img/Icons_Viaf_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="VIAF"
                                    src="template/img/Icons_Viaf_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":viafModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>
                        
                        <ui:fragment rendered="#{cc.attrs.metadata.outputType == 'vocabularySearch'}">
                            <h:commandLink
                                styleClass="change-icon vocabularySearchIndexTrigger"
                                title="#{msgs.NORM_vocabularySearch}"
                                pt:aria-label="#{msgs.NORM_vocabularySearch}"
                                onclick="$('#vocabularySearchBox').modal('show');">
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="Vocabulary"
                                    src="template/img/Icons_Vocabulary_grey.png" />
                                <img
                                    class="toggle"
                                    style="width: 16px;"
                                    alt="Vocabulary"
                                    src="template/img/Icons_Vocabulary_color.png" />
                                <f:setPropertyActionListener
                                    value="#{cc.attrs.metadata}"
                                    target="#{Metadaten.currentMetadataToPerformSearch}" />
                                <f:ajax
                                    execute="@this"
                                    render=":vocabularySearchModalContent" />
                                <f:passThroughAttribute
	                                name="data-toggle"
	                                value="tooltip" />
	                            <f:passThroughAttribute
	                                name="data-placement"
	                                value="top" />
                            </h:commandLink>
                        </ui:fragment>
                    </div>
                </ui:fragment>
            </div>
        </div>

        <hr />
    </composite:implementation>
</ui:composition>